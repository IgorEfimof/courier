<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="apple-touch-icon" sizes="180x180" href="icons/icon195.png">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="COUR">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Калькулятор заработка курьера</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2c3e50;
            --text-color: #333;
            --bg-color: #f5f7fa;
            --card-bg: #ffffff;
            --input-bg: #ffffff;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --border-color: #ddd;
            --result-title-color: #2c3e50;
            --result-value-color: #27ae60;
            --summary-bg: #e8f4fc;
            --summary-title-color: #2980b9;
            --warning-color: #e74c3c;
            --highlight-color: #f39c12;
            --keyboard-bg: #2c3e50;
            --key-color: #ecf0f1;
            --key-bg: #3498db;
            --key-active-bg: #2980b9;
        }

        .dark-theme {
            --primary-color: #2980b9;
            --secondary-color: #1a252f;
            --text-color: #ecf0f1;
            --bg-color: #1a252f;
            --card-bg: #2c3e50;
            --input-bg: #34495e;
            --shadow-color: rgba(0, 0, 0, 0.3);
            --border-color: #4a6572;
            --result-title-color: #ecf0f1;
            --result-value-color: #2ecc71;
            --summary-bg: #34495e;
            --summary-title-color: #3498db;
            --warning-color: #e74c3c;
            --highlight-color: #f39c12;
            --keyboard-bg: #1a252f;
            --key-color: #ecf0f1;
            --key-bg: #2980b9;
            --key-active-bg: #3498db;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            transition: background-color 0.3s, color 0.3s;
            -webkit-tap-highlight-color: transparent;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }

        input {
            -webkit-user-select: text;
            user-select: text;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.4;
            padding: 10px;
            min-height: 100vh;
            position: relative;
            padding-bottom: 70px;
            touch-action: manipulation;
            -webkit-text-size-adjust: 100%;
        }

        .container {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 8px;
            box-shadow: 0 0 10px var(--shadow-color);
            overflow: hidden;
        }

        header {
            background: var(--secondary-color);
            color: white;
            padding: 12px 15px;
            position: relative;
        }

        h1 {
            font-size: 1.4rem;
            margin-bottom: 4px;
            text-align: center;
        }

        .description {
            font-size: 0.85rem;
            opacity: 0.9;
            text-align: center;
        }

        .theme-switch {
            position: absolute;
            right: 15px;
            top: 12px;
        }

        .theme-switch-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .theme-switch-label i {
            margin-right: 4px;
        }

        .content {
            display: flex;
            flex-wrap: wrap;
            padding: 12px;
        }

        .input-section, .results-section {
            flex: 1;
            min-width: 300px;
            padding: 12px;
        }

        .input-section {
            background: var(--card-bg);
            border-radius: 6px;
            margin-right: 12px;
        }

        .section-title {
            color: var(--primary-color);
            margin-bottom: 12px;
            padding-bottom: 4px;
            border-bottom: 1px solid var(--border-color);
            font-size: 1.1rem;
        }

        .form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .form-group {
            flex: 1;
        }

        label {
            display: block;
            margin-bottom: 4px;
            font-weight: 600;
            font-size: 0.85rem;
        }

        input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 16px;
            background-color: var(--input-bg);
            color: var(--text-color);
            caret-color: transparent;
        }

        /* Кастомная клавиатура */
        .custom-keyboard {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: var(--keyboard-bg);
            padding: 10px;
            display: none;
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.2);
            touch-action: manipulation;
        }

        .keyboard-visible {
            display: block;
        }

        .keyboard-row {
            display: flex;
            justify-content: center;
            margin-bottom: 8px;
        }

        .keyboard-key {
            width: 60px;
            height: 50px;
            margin: 0 5px;
            background: var(--key-bg);
            color: var(--key-color);
            border: none;
            border-radius: 5px;
            font-size: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            touch-action: manipulation;
        }

        .keyboard-key:active {
            background: var(--key-active-bg);
        }

        .key-wide {
            width: 130px;
        }

        .key-actions {
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }

        .key-action {
            padding: 10px 20px;
            margin: 0 5px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        button {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            width: 100%;
            margin-top: 8px;
            transition: background 0.3s;
            touch-action: manipulation;
        }

        button:hover {
            background: var(--secondary-color);
        }

        /* Компактное расположение результатов */
        .compact-results {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .compact-result {
            flex: 1;
            min-width: 120px;
            background: var(--card-bg);
            padding: 10px;
            border-radius: 6px;
            box-shadow: 0 1px 3px var(--shadow-color);
            text-align: center;
        }

        .compact-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--result-title-color);
            font-size: 0.85rem;
            white-space: nowrap;
        }

        .compact-value {
            font-size: 1rem;
            font-weight: 700;
            color: var(--result-value-color);
            white-space: nowrap;
        }

        .compact-summary {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .compact-summary-item {
            flex: 1;
            background: var(--summary-bg);
            padding: 10px;
            border-radius: 6px;
            text-align: center;
        }

        .summary-title {
            font-weight: 700;
            margin-bottom: 5px;
            color: var(--summary-title-color);
            font-size: 0.9rem;
        }

        .summary-value {
            font-size: 1rem;
            font-weight: 700;
            color: var(--result-value-color);
        }

        .average-value {
            color: var(--highlight-color);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .info-text {
            font-size: 0.8rem;
            color: var(--primary-color);
            margin-top: 4px;
            text-align: center;
        }

        /* Мобильная адаптация */
        @media (max-width: 768px) {
            body {
                padding: 8px;
                padding-bottom: 70px;
            }
            
            header {
                padding: 10px 12px;
            }
            
            h1 {
                font-size: 1.2rem;
            }
            
            .theme-switch {
                position: static;
                margin-top: 8px;
                text-align: center;
            }
            
            .content {
                flex-direction: column;
                padding: 10px;
            }
            
            .input-section {
                margin-right: 0;
                margin-bottom: 12px;
            }
            
            .input-section, .results-section {
                padding: 10px;
            }
            
            .section-title {
                font-size: 1rem;
            }
            
            .compact-results, .compact-summary {
                flex-direction: row;
                gap: 8px;
            }
            
            .compact-result, .compact-summary-item {
                min-width: calc(50% - 10px);
            }
            
            input, button {
                padding: 8px;
                font-size: 16px;
            }
            
            .compact-value, .summary-value {
                font-size: 0.95rem;
            }

            .keyboard-key {
                width: 50px;
                height: 45px;
                font-size: 18px;
            }

            .key-wide {
                width: 110px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.1rem;
            }
            
            .description {
                font-size: 0.8rem;
            }
            
            .section-title {
                font-size: 0.95rem;
            }
            
            label, button {
                font-size: 14px;
            }
            
            input {
                font-size: 16px;
            }
            
            .compact-title {
                font-size: 0.82rem;
            }
            
            .compact-value, .summary-value {
                font-size: 0.9rem;
            }
            
            .info-text {
                font-size: 0.78rem;
            }
            
            .theme-switch-label {
                font-size: 0.8rem;
            }

            .keyboard-key {
                width: 45px;
                height: 40px;
                font-size: 16px;
                margin: 0 3px;
            }

            .key-wide {
                width: 95px;
            }
        }

        @media (max-width: 360px) {
            .input-section, .results-section {
                padding: 8px;
            }
            
            .form-row {
                margin-bottom: 6px;
            }
            
            input {
                padding: 8px;
            }
            
            .compact-result, .compact-summary-item {
                padding: 8px;
                min-width: calc(50% - 8px);
            }

            .keyboard-key {
                width: 40px;
                height: 35px;
                font-size: 14px;
            }

            .key-wide {
                width: 85px;
            }
        }
    </style>
</head>
<body class="light-theme">
    <div class="container">
        <header>
            <div>
                <h1>Калькулятор заработка курьера</h1>
                <p class="description">Расчет доходов с учетом расходов</p>
            </div>
            <div class="theme-switch">
                <label class="theme-switch-label">
                    <input type="checkbox" id="theme-toggle">
                    <i class="fas fa-moon"></i> Тёмная тема
                </label>
            </div>
        </header>
        
        <div class="content">
            <div class="input-section">
                <h2 class="section-title">Параметры работы</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="orders-per-hour">Заказов в час</label>
                        <input type="text" id="orders-per-hour" inputmode="decimal" value="2,5" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="income-per-hour">Сумма за час (руб.)</label>
                        <input type="text" id="income-per-hour" inputmode="decimal" value="375" readonly>
                    </div>
                </div>
                
                <div class="form-group">
                    <p class="info-text">Средняя сумма заказа: <span id="average-order" class="average-value">150,00 руб.</span></p>
                </div>
                
                <div class="form-group">
                    <label for="hours-per-day">Рабочих часов в день</label>
                    <input type="text" id="hours-per-day" inputmode="decimal" value="8" readonly>
                </div>
                
                <h2 class="section-title">Расходы</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="fuel-per-day">Бензин (л/день)</label>
                        <input type="text" id="fuel-per-day" inputmode="decimal" value="5" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="fuel-price">Цена бензина (руб.)</label>
                        <input type="text" id="fuel-price" inputmode="decimal" value="50" readonly>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="other-costs">Другие расходы (руб./день)</label>
                    <input type="text" id="other-costs" inputmode="decimal" value="200" readonly>
                </div>
                
                <h2 class="section-title">График работы</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="work-days-week">Дней в неделю</label>
                        <input type="text" id="work-days-week" inputmode="numeric" value="6" readonly>
                    </div>
                    
                    <div class="form-group">
                        <label for="work-days-month">Дней в месяц</label>
                        <input type="text" id="work-days-month" inputmode="numeric" value="24" readonly>
                </div>
                </div>
                
                <button id="calculate-btn">Рассчитать</button>
            </div>
            
            <div class="results-section">
                <h2 class="section-title">Результаты за день</h2>
                
                <div class="compact-results">
                    <div class="compact-result">
                        <div class="compact-title">Заказов</div>
                        <div class="compact-value" id="daily-orders">20,00</div>
                    </div>
                    
                    <div class="compact-result">
                        <div class="compact-title">Доход</div>
                        <div class="compact-value" id="daily-income">3000,00 руб.</div>
                    </div>
                    
                    <div class="compact-result">
                        <div class="compact-title">Расходы</div>
                        <div class="compact-value" id="daily-costs">450,00 руб.</div>
                    </div>
                    
                    <div class="compact-result">
                        <div class="compact-title">Чистый доход</div>
                        <div class="compact-value" id="daily-profit">2550,00 руб.</div>
                    </div>
                </div>
                
                <h2 class="section-title">Итоговый заработок</h2>
                
                <div class="compact-summary">
                    <div class="compact-summary-item">
                        <div class="summary-title">В неделю</div>
                        <div class="summary-value" id="weekly-profit">15300,00 руб.</div>
                    </div>
                    
                    <div class="compact-summary-item">
                        <div class="summary-title">В месяц</div>
                        <div class="summary-value" id="monthly-profit">61200,00 руб.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Кастомная клавиатура -->
    <div class="custom-keyboard" id="custom-keyboard">
        <div class="keyboard-row">
            <button class="keyboard-key" data-value="7">7</button>
            <button class="keyboard-key" data-value="8">8</button>
            <button class="keyboard-key" data-value="9">9</button>
            <button class="keyboard-key" data-action="backspace"><i class="fas fa-backspace"></i></button>
        </div>
        <div class="keyboard-row">
            <button class="keyboard-key" data-value="4">4</button>
            <button class="keyboard-key" data-value="5">5</button>
            <button class="keyboard-key" data-value="6">6</button>
            <button class="keyboard-key" data-action="clear">C</button>
        </div>
        <div class="keyboard-row">
            <button class="keyboard-key" data-value="1">1</button>
            <button class="keyboard-key" data-value="2">2</button>
            <button class="keyboard-key" data-value="3">3</button>
            <button class="keyboard-key" data-value=",">,</button>
        </div>
        <div class="keyboard-row">
            <button class="keyboard-key key-wide" data-value="0">0</button>
            <button class="keyboard-key key-wide" data-action="hide">Готово</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Элементы DOM
            const calculateBtn = document.getElementById('calculate-btn');
            const themeToggle = document.getElementById('theme-toggle');
            const customKeyboard = document.getElementById('custom-keyboard');
            
            // Параметры работы
            const ordersPerHourInput = document.getElementById('orders-per-hour');
            const incomePerHourInput = document.getElementById('income-per-hour');
            const hoursPerDayInput = document.getElementById('hours-per-day');
            const averageOrderElement = document.getElementById('average-order');
            
            // Расходы
            const fuelPerDayInput = document.getElementById('fuel-per-day');
            const fuelPriceInput = document.getElementById('fuel-price');
            const otherCostsInput = document.getElementById('other-costs');
            
            // График работы
            const workDaysWeekInput = document.getElementById('work-days-week');
            const workDaysMonthInput = document.getElementById('work-days-month');
            
            // Результаты
            const dailyOrdersElement = document.getElementById('daily-orders');
            const dailyIncomeElement = document.getElementById('daily-income');
            const dailyCostsElement = document.getElementById('daily-costs');
            const dailyProfitElement = document.getElementById('daily-profit');
            const weeklyProfitElement = document.getElementById('weekly-profit');
            const monthlyProfitElement = document.getElementById('monthly-profit');
            
            // Текущее активное поле ввода
            let activeInput = null;
            
            // Функция для замены точки на запятую в числах
            function formatNumberWithComma(number) {
                return number.toString().replace('.', ',');
            }
            
            // Функция для замены запятой на точку в числах
            function parseNumberWithComma(value) {
                if (typeof value === 'string') {
                    return parseFloat(value.replace(',', '.'));
                }
                return value;
            }
            
            // Предотвращение масштабирования при двойном тапе
            document.addEventListener('dblclick', function(e) {
                e.preventDefault();
            });
            
            document.addEventListener('touchstart', function(e) {
                if (e.touches.length > 1) {
                    e.preventDefault();
                }
            }, { passive: false });
            
            let lastTouchEnd = 0;
            document.addEventListener('touchend', function(e) {
                const now = (new Date()).getTime();
                if (now - lastTouchEnd <= 300) {
                    e.preventDefault();
                }
                lastTouchEnd = now;
            }, { passive: false });

            // Функция расчета средней суммы заказа
            function calculateAverageOrder() {
                const ordersPerHour = parseNumberWithComma(ordersPerHourInput.value) || 0;
                const incomePerHour = parseNumberWithComma(incomePerHourInput.value) || 0;
                
                if (ordersPerHour > 0) {
                    const averageOrder = incomePerHour / ordersPerHour;
                    averageOrderElement.textContent = formatNumberWithComma(averageOrder.toFixed(2)) + ' руб.';
                } else {
                    averageOrderElement.textContent = '0,00 руб.';
                }
            }
            
            // Функция расчета
            function calculate() {
                // Получаем значения из полей ввода
                const ordersPerHour = parseNumberWithComma(ordersPerHourInput.value) || 0;
                const incomePerHour = parseNumberWithComma(incomePerHourInput.value) || 0;
                const hoursPerDay = parseNumberWithComma(hoursPerDayInput.value) || 0;
                
                const fuelPerDay = parseNumberWithComma(fuelPerDayInput.value) || 0;
                const fuelPrice = parseNumberWithComma(fuelPriceInput.value) || 0;
                const otherCosts = parseNumberWithComma(otherCostsInput.value) || 0;
                
                const workDaysWeek = parseNumberWithComma(workDaysWeekInput.value) || 0;
                const workDaysMonth = parseNumberWithComma(workDaysMonthInput.value) || 0;
                
                // Рассчитываем среднюю сумму заказа
                calculateAverageOrder();
                
                // Выполняем расчеты
                const dailyOrders = ordersPerHour * hoursPerDay;
                const dailyIncome = incomePerHour * hoursPerDay;
                const dailyFuelCost = fuelPerDay * fuelPrice;
                const dailyCosts = dailyFuelCost + otherCosts;
                const dailyProfit = dailyIncome - dailyCosts;
                
                const weeklyProfit = dailyProfit * workDaysWeek;
                const monthlyProfit = dailyProfit * workDaysMonth;
                
                // Обновляем результаты на странице
                dailyOrdersElement.textContent = formatNumberWithComma(dailyOrders.toFixed(2));
                dailyIncomeElement.textContent = formatNumberWithComma(dailyIncome.toFixed(2)) + ' руб.';
                dailyCostsElement.textContent = formatNumberWithComma(dailyCosts.toFixed(2)) + ' руб.';
                dailyProfitElement.textContent = formatNumberWithComma(dailyProfit.toFixed(2)) + ' руб.';
                weeklyProfitElement.textContent = formatNumberWithComma(weeklyProfit.toFixed(2)) + ' руб.';
                monthlyProfitElement.textContent = formatNumberWithComma(monthlyProfit.toFixed(2)) + ' руб.';
            }
            
            // Показать кастомную клавиатуру
            function showKeyboard() {
                customKeyboard.classList.add('keyboard-visible');
            }
            
            // Скрыть кастомную клавиатуру
            function hideKeyboard() {
                customKeyboard.classList.remove('keyboard-visible');
                activeInput = null;
            }
            
            // Обработчики событий для полей ввода
            const allInputs = document.querySelectorAll('input');
            allInputs.forEach(input => {
                input.addEventListener('focus', function() {
                    activeInput = this;
                    showKeyboard();
                });
                
                // Отключаем стандартную клавиатуру на touch-устройствах
                input.addEventListener('click', function(e) {
                    e.preventDefault();
                    this.focus();
                });
            });
            
            // Обработчики для кнопок кастомной клавиатуры
            document.querySelectorAll('.keyboard-key').forEach(key => {
                key.addEventListener('click', function() {
                    if (!activeInput) return;
                    
                    const value = this.getAttribute('data-value');
                    const action = this.getAttribute('data-action');
                    
                    if (action === 'backspace') {
                        // Удаление последнего символа
                        activeInput.value = activeInput.value.slice(0, -1);
                    } else if (action === 'clear') {
                        // Очистка поля
                        activeInput.value = '';
                    } else if (action === 'hide') {
                        // Скрытие клавиатуры
                        hideKeyboard();
                        return;
                    } else if (value) {
                        // Добавление значения
                        // Проверка для десятичных чисел
                        if (value === ',' && activeInput.value.includes(',')) {
                            return; // Не добавляем вторую запятую
                        }
                        
                        // Если поле пустое и добавляем запятую, то добавляем "0," вместо просто ","
                        if (value === ',' && activeInput.value === '') {
                            activeInput.value = '0,';
                        } else {
                            activeInput.value += value;
                        }
                    }
                    
                    // Запускаем расчет после изменения значения
                    calculate();
                });
            });
            
            // Скрытие клавиатуры при клике вне поля ввода
            document.addEventListener('click', function(e) {
                if (!e.target.closest('input') && !e.target.closest('.custom-keyboard')) {
                    hideKeyboard();
                }
            });
            
            // Обработчик события для кнопки расчета
            calculateBtn.addEventListener('click', calculate);
            
            // Автоматический расчет при изменении любого поля
            allInputs.forEach(input => {
                input.addEventListener('input', calculate);
            });
            
            // Переключение темы
            themeToggle.addEventListener('change', function() {
                if (this.checked) {
                    document.body.classList.remove('light-theme');
                    document.body.classList.add('dark-theme');
                    localStorage.setItem('theme', 'dark');
                } else {
                    document.body.classList.remove('dark-theme');
                    document.body.classList.add('light-theme');
                    localStorage.setItem('theme', 'light');
                }
            });
            
            // Проверка сохраненной темы
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                themeToggle.checked = true;
                document.body.classList.remove('light-theme');
                document.body.classList.add('dark-theme');
            }
            
            // Первоначальный расчет
            calculate();
        });
    </script>
</body>
</html>
